
{% extends 'jokes/base.html' %}

{% block title %}{{ joke.title|default:"–ê–Ω–µ–∫–¥–æ—Ç" }} - –ê–Ω–µ–∫–¥–æ—Ç—ã{% endblock %}

{% block content %}
<div class="joke-card">
    <div class="joke-meta">
        <span class="category-tag">{{ joke.get_category_display }}</span>
        <span>{{ joke.created_at|date:"d.m.Y H:i" }} | –ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: {{ joke.views }}</span>
    </div>
    
    {% if joke.title %}
        <h1>{{ joke.title }}</h1>
    {% endif %}
    
    <div class="joke-content joke-detail-content">{{ joke.content|linebreaks }}</div>
    
    <div class="joke-actions">
        {% csrf_token %}
        <div class="rating">
            <button onclick="rateJoke({{ joke.id }}, 'up')" class="up">üëç –ù—Ä–∞–≤–∏—Ç—Å—è</button>
            <span id="rating-{{ joke.id }}">{{ joke.rating }}</span>
            <button onclick="rateJoke({{ joke.id }}, 'down')" class="down">üëé –ù–µ –Ω—Ä–∞–≤–∏—Ç—Å—è</button>
        </div>
        <a href="{% url 'jokes:list' %}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
        <a href="{% url 'jokes:random' %}" class="btn btn-primary">–°–ª—É—á–∞–π–Ω—ã–π –∞–Ω–µ–∫–¥–æ—Ç</a>
    </div>
</div>

{% if related_jokes %}
<h2>–ü–æ—Ö–æ–∂–∏–µ –∞–Ω–µ–∫–¥–æ—Ç—ã</h2>
{% for related in related_jokes %}
<div class="joke-card">
    <div class="joke-meta">
        <span class="category-tag">{{ related.get_category_display }}</span>
        <span>{{ related.created_at|date:"d.m.Y H:i" }}</span>
    </div>
    
    {% if related.title %}
        <h3>{{ related.title }}</h3>
    {% endif %}
    
    <div class="joke-content">{{ related.get_short_content|linebreaks }}</div>
    
    <div class="joke-actions">
        <a href="{% url 'jokes:detail' related.id %}" class="btn btn-primary">–ß–∏—Ç–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é</a>
    </div>
</div>
{% endfor %}
{% endif %}
{% endblock %}
